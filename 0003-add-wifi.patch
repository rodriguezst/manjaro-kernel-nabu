From 61bd09e2d2e2e646842ba19acd3a308146f8c8f1 Mon Sep 17 00:00:00 2001
From: maverick <maverick_jia@sina.com>
Date: Sat, 3 Jun 2023 15:54:59 +0800
Subject: [PATCH 03/45] add wifi

---
 .../dts/qcom/sm8150-xiaomi-nabu-maverick.dts  | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)

diff --git a/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu-maverick.dts b/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu-maverick.dts
index 329a92f32..f19abd9e9 100644
--- a/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu-maverick.dts
+++ b/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu-maverick.dts
@@ -8,8 +8,6 @@
 
 #include <dt-bindings/regulator/qcom,rpmh-regulator.h>
 #include <dt-bindings/gpio/gpio.h>
-#include <dt-bindings/phy/phy.h>
-#include <dt-bindings/sound/qcom,q6asm.h>
 #include <dt-bindings/usb/pd.h>
 #include "sm8150.dtsi"
 #include "pm8150.dtsi"
@@ -295,8 +293,8 @@ vreg_l12a_1p8: ldo12 {
 		};
 
 		vreg_l13a_2p7: ldo13 {
-			regulator-min-microvolt = <3000000>;
-			regulator-max-microvolt = <3000000>;
+			regulator-min-microvolt = <2704000>;
+			regulator-max-microvolt = <2704000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
 
@@ -421,7 +419,7 @@ vreg_l10c_3p3: ldo10 {
 		};
 
 		vreg_l11c_3p3: ldo11 {
-			regulator-min-microvolt = <3104000>;
+			regulator-min-microvolt = <3000000>;
 			regulator-max-microvolt = <3312000>;
 			regulator-initial-mode = <RPMH_REGULATOR_MODE_HPM>;
 		};
@@ -589,7 +587,6 @@ &usb_2_dwc3 {
 	dr_mode = "host";
 };
 
-#if 1
 &pm8150b_vbus {
 	regulator-min-microamp = <500000>;
 	regulator-max-microamp = <3000000>;
@@ -616,7 +613,6 @@ PDO_FIXED_USB_COMM |
 #endif
 	};
 };
-#endif
 
 &soc {
 	xiaomi_keyboard {
@@ -632,3 +628,12 @@ xiaomi_keyboard {
 		status = "ok";
 	};
 };
+
+&wifi {
+	status = "okay";
+
+	vdd-0.8-cx-mx-supply = <&vreg_l1a_0p75>;
+	vdd-1.8-xo-supply = <&vreg_l7a_1p8>;
+	vdd-1.3-rfa-supply = <&vreg_l2c_1p3>;
+	vdd-3.3-ch0-supply = <&vreg_l11c_3p3>;
+};
\ No newline at end of file
-- 
2.46.0

