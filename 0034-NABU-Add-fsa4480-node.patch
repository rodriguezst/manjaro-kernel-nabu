From a80be439d9fcd4bc3a03abb9058a0c2f20cbab43 Mon Sep 17 00:00:00 2001
From: map220v <map220v300@gmail.com>
Date: Tue, 9 Jan 2024 11:58:41 +0000
Subject: [PATCH 34/40] NABU: Add fsa4480 node

---
 .../boot/dts/qcom/sm8150-xiaomi-nabu.dts      | 28 +++++++++++++++++++
 1 file changed, 28 insertions(+)

diff --git a/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu.dts b/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu.dts
index 3d126ee465..67c02f2d4f 100644
--- a/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu.dts
+++ b/arch/arm64/boot/dts/qcom/sm8150-xiaomi-nabu.dts
@@ -491,6 +491,26 @@ backlight: backlight@11 {
 	};
 };
 
+&i2c4 {
+	status = "okay";
+
+	typec-mux@43 {
+		compatible = "fcs,fsa4480";
+		reg = <0x43>;
+
+		vcc-supply = <&vreg_bob>;
+
+		mode-switch;
+		orientation-switch;
+
+		port {
+			fsa4480_sbu_mux: endpoint {
+				remote-endpoint = <&pm8150b_sbu_mux_in>;
+			};
+		};
+	};
+};
+
 &i2c7 {
 	status = "okay";
 
@@ -683,6 +703,14 @@ pm8150b_role_switch_in: endpoint {
 					remote-endpoint = <&usb_1_role_switch_out>;
 				};
 			};
+
+			port@1 {
+				reg = <1>;
+
+				pm8150b_sbu_mux_in: endpoint {
+					remote-endpoint = <&fsa4480_sbu_mux>;
+				};
+			};
 		};
 	};
 };
-- 
2.46.0

